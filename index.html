<!DOCTYPE html>
<html>
    <head>
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-138655244-1"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'UA-138655244-1');
        </script>


        <meta charset="utf-8">
        <title>TAB Bonus Bet Calculator</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css"></link>        
    </head>
    <body>
        <div class="content">
            <h1>tabulous</h1>
            <div class="description">Maximise your minimum gain for a set of head-to-head bets, using your bonus bet from the TAB.</div>
            <div class="section">
                <div class="left">
                    <div class="tabLabel"><label for="bonusBet">Bonus Bet </label></div>
                    <div><input id="bonusBet" type="text" value="10"/></div>
                </div>
                <div class="right">
                    <div class="tabLabel"><label for="maxBet">Maximum Stake </label></div>
                    <div><input id="maxBet" type="text" value="20"/></div>
                </div>
                <div class="clear"></div>
            </div>
            <div class="section">
                <div class="heading centered">Head-to-Head Odds</div>

                <div class="left"><input id="oddsA1" type="text" value="1.59"></div>
                <div class="right"><input id="oddsB1" type="text" value="2.31"></div>

                <div class="left"><input id="oddsA2" type="text"></div>
                <div class="right"><input id="oddsB2" type="text"></div>

                <div class="left"><input id="oddsA3" type="text"></div>
                <div class="right"><input id="oddsB3" type="text"></div>

                <div class="left"><input id="oddsA4" type="text"></div>
                <div class="right"><input id="oddsB4" type="text"></div>

                <div class="left"><input id="oddsA5" type="text"></div>
                <div class="right"><input id="oddsB5" type="text"></div>

                <div class="left"><input id="oddsA6" type="text"></div>
                <div class="right"><input id="oddsB6" type="text"></div>

                <div class="left"><input id="oddsA7" type="text"></div>
                <div class="right"><input id="oddsB7" type="text"></div>

                <div class="left"><input id="oddsA8" type="text"></div>
                <div class="right"><input id="oddsB8" type="text"></div>

                <div class="left"><input id="oddsA9" type="text"></div>
                <div class="right"><input id="oddsB9" type="text"></div>

                <div class="left"><input id="oddsA10" type="text"></div>
                <div class="right"><input id="oddsB10" type="text"></div>
                
                <div class="clear"></div>
            </div>
            <div>
                <div class="centered go">
                    <button id="calculate" class="btn" onclick="calculate();">Calculate</button>
                </div>
            </div>
<img src="sso.png" />
            <div id="result">
                <div>You should bet 
                    <span id="dollarsToBet"></span> 
                    dollars on the 
                    $<span id="betOption"></span> 
                    option, and put your bonus bet on the 
                    $<span id="bonusOption"></span> 
                    option, for a minimum gain of 
                    $<span id="gain"></span>.
                </div>
            </div>
            <div id="debug"></div>
        </div>
        <script>
            $(document).ready(function() {
                $("#result").hide();
            });

            function calculate(){
                
                var bet;
                var headToHead;
                var bonusBet = parseFloat($("#bonusBet").val());
                var maxBet = parseFloat($("#maxBet").val());

                var mins = {};

                var minAB;
                var minBA;
                var max = 0;
                var dollarsToBet = 0;
                var option = 0;
                var gain = 0;

                for (headToHead = 1; headToHead <= 10; headToHead++) {
                    
                    var oddsA = parseFloat($("#oddsA" + headToHead).val());
                    var oddsB = parseFloat($("#oddsB" + headToHead).val());
                    
                    //$("#debug").html($("#debug").html() + "x" + "<br />");
                    
                    if (oddsA > 0 && oddsB > 0 ) {

                        for (bet = maxBet; bet > 0; bet--) {
                            minAB = +Math.min((oddsA*bet)-bet, ((oddsB*bonusBet)-bonusBet)-bet).toFixed(2);
                            minBA = +Math.min((oddsB*bet)-bet, ((oddsA*bonusBet)-bonusBet)-bet).toFixed(2);
                            
                            var currentMax = Math.max(minAB, minBA);

                            if (currentMax > max) {
                                
                                $("#dollarsToBet").html(bet);

                                if (minAB > minBA) {
                                    $("#betOption").html(oddsA);
                                    $("#bonusOption").html(oddsB);
                                    $("#gain").html(minAB);
                                } else {
                                    $("#betOption").html(oddsB);
                                    $("#bonusOption").html(oddsA);
                                    $("#gain").html(minBA);
                                }
                            }

                            max = Math.max(max, currentMax);
                        }
                    }
                }

                $("#result").show();
            }
        </script>
    </body>
</html>
